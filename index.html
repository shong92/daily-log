<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Í∏∞ÌöçÏÑ∏Ìè¨ ÏùºÏùºÎ°úÍ∑∏</title>
<style>
    :root {
      --bg: #f8f8f8;
      --fg: #000;
      --card: #fff;
      --border: #ccc;
      --accent: #4a90e2;
      --entry-border: #eee;
    }

    body.dark {
      --bg: #121212;
      --fg: #f2f2f2;
      --card: #1e1e1e;
      --border: #333;
      --accent: #90c3ff;
      --entry-border: #444;
    }

    body {
      background: var(--bg);
      color: var(--fg);
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }

    .wrapper {
      display: flex;
      justify-content: center;
      padding: 2em 1em;
    }

    .container {
      width: 100%;
      max-width: 600px;
      background: var(--card);
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      border-radius: 10px;
      border: 1px solid var(--border);
      position: relative;
    }

    .dark-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      font-size: 1.2em;
      cursor: pointer;
      color: var(--fg);
      z-index: 10;
    }

    h2 {
      font-size: 1.5em;
      text-align: center;
      margin: 0 0 20px 0;
    }

    input[type="date"],
    input[type="text"],
    textarea,
    button {
      width: 100%;
      box-sizing: border-box;
      margin-top: 10px;
      padding: 10px;
      font-size: 1em;
      border: 1px solid var(--border);
      border-radius: 5px;
      background: var(--card);
      color: var(--fg);
    }

    .emoji-picker {
      margin-top: 5px;
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }

    .emoji {
      cursor: pointer;
      font-size: 1.3em;
    }

    .log-entry {
      position: relative;
      padding: 10px 0;
      padding-right: 40px;
      border-bottom: 1px solid var(--entry-border);
      display: flex;
      flex-direction: column;
      gap: 4px;
      word-wrap: break-word;
    }

    .log-entry-content {
      padding-right: 60px;
    }

    .time {
      color: #888;
      font-size: 0.85em;
    }

    .delete-btn {
      display: none;
      position: absolute;
      right: 1px;
      top: 1px;
      padding: 2px 5px;
      font-size: 0.7em;
      border: 1px solid var(--accent);
      color: var(--accent);
      background: none;
      border-radius: 4px;
      cursor: pointer;
      white-space: nowrap;
    
      position: absolute;
      top: 1px;
      right: 1px;
      background: none;
      border: none;
      font-size: 1.1em;
      cursor: pointer;
      color: var(--accent);
      transition: 0.2s;
      z-index: 5;
      display: none;
    }

    .log-entry:hover .delete-btn {
      display: none;
      position: absolute;
      right: 10px;
      top: 10px;
      padding: 2px 5px;
      font-size: 0.7em;
      border: 1px solid var(--accent);
      color: var(--accent);
      background: none;
      border-radius: 4px;
      cursor: pointer;
      white-space: nowrap;
    
      display: block;
    }

    @media (hover: none) {
      .delete-btn {
      display: none;
      position: absolute;
      right: 10px;
      top: 10px;
      padding: 2px 5px;
      font-size: 0.7em;
      border: 1px solid var(--accent);
      color: var(--accent);
      background: none;
      border-radius: 4px;
      cursor: pointer;
      white-space: nowrap;
    
        display: block !important;
      }
    }
  
.log-entry:hover .delete-btn { display: inline-block; }</style>
</head>
<body>
<div id="passwordModal" style="
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;">
<div style="background:white; padding: 30px; border-radius: 8px; text-align:center; width: 300px;">
<h3>üîê ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•</h3>
<input id="passwordInput" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•" style="width: 100%; margin-top: 10px; padding: 8px;" type="password"/>
<button onclick="submitPassword()" style="margin-top: 10px; width: 100%;">ÌôïÏù∏</button>
</div>
</div>


<div class="wrapper">
<div class="container">
<button class="dark-toggle" onclick="toggleDarkMode()">üåô</button>
<h2>üìù Í∏∞ÌöçÏÑ∏Ìè¨ ÏùºÏùºÎ°úÍ∑∏</h2>
<input id="dateFilter" onchange="filterLogs()" type="date"/>
<input id="searchInput" oninput="filterLogs()" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" type="text"/>
<textarea id="logText" placeholder="Ïò§ÎäòÏùò ÌôúÎèôÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..."></textarea>
<div class="emoji-picker">
<span class="emoji" onclick="insertEmoji('üòä')">üòä</span>
<span class="emoji" onclick="insertEmoji('üî•')">üî•</span>
<span class="emoji" onclick="insertEmoji('üí°')">üí°</span>
<span class="emoji" onclick="insertEmoji('‚úèÔ∏è')">‚úèÔ∏è</span>
<span class="emoji" onclick="insertEmoji('‚úÖ')">‚úÖ</span>
<span class="emoji" onclick="insertEmoji('‚ú®')">‚ú®</span>
<span class="emoji" onclick="insertEmoji('‚ö°')">‚ö°</span>
</div>
<button onclick="saveLog()" type="button">‚úÖ Í∏∞Î°ùÌïòÍ∏∞</button>
<div id="logList"></div>
</div>
</div>

<script>
const correctHash = "5dfa4c51dcc091801d8a6b6d2aed69119239a1f4e458cc06a326c6a9b0a09576";
async function sha256(text) {
  const encoded = new TextEncoder().encode(text);
  const buffer = await crypto.subtle.digest("SHA-256", encoded);
  return Array.from(new Uint8Array(buffer)).map(b => b.toString(16).padStart(2, "0")).join("");
}
async function submitPassword() {
  const input = document.getElementById("passwordInput").value;
  const hashed = await sha256(input);
  if (hashed === correctHash) {
    document.getElementById("passwordModal").style.display = "none";
    localStorage.setItem("dailyLogUnlocked", "true");
    initLog();
  } else {
    alert("ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÌãÄÎ†∏ÏäµÎãàÎã§.");
  }
}
if (localStorage.getItem("dailyLogUnlocked") === "true") {
  window.addEventListener("DOMContentLoaded", initLog);
} else {
  document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("passwordModal").style.display = "flex";
  });
}

function initLog() {
  const logKey = "dailyLogData";
  const darkKey = "logAppDarkMode";

  function loadLogs() {
    return JSON.parse(localStorage.getItem(logKey)) || [];
  }

  function saveLog() {
    const text = document.getElementById('logText').value.trim();
    if (!text) return;
    const now = new Date();
    const date = now.toISOString().slice(0, 10);
    const time = now.toLocaleTimeString();
    const id = Date.now();
    const newLog = { id, text, date, time };
    const logs = loadLogs();
    logs.push(newLog);
    localStorage.setItem(logKey, JSON.stringify(logs));
    document.getElementById('logText').value = '';
    filterLogs();
  }

  function deleteLog(id) {
    let logs = loadLogs();
    logs = logs.filter(log => log.id !== id);
    localStorage.setItem(logKey, JSON.stringify(logs));
    filterLogs();
  }

  function renderLogs(filteredLogs) {
    const logList = document.getElementById('logList');
    logList.innerHTML = '';
    filteredLogs.reverse().forEach(({ id, text, date, time }) => {
      const logHTML = `
        <div class="log-entry">
          <div class="log-entry-content">
            <div class="time">${date} ${time}</div>
            <div>${text}</div>
          </div>
          <button class="delete-btn" onclick="deleteLog(${id})">ÏÇ≠Ï†ú</button>
        </div>`;
      logList.insertAdjacentHTML('beforeend', logHTML);
    });
  }

  function filterLogs() {
    const selectedDate = document.getElementById('dateFilter').value;
    const allLogs = loadLogs();
    const filtered = selectedDate
      ? allLogs.filter(log => log.date === selectedDate)
      : allLogs;
    renderLogs(filtered);
  }

  document.getElementById('logText').addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      saveLog();
    }
  });

  document.querySelector("button[onclick='saveLog()']").addEventListener("click", saveLog);

  window.insertEmoji = function(emoji) {
    const textarea = document.getElementById('logText');
    textarea.value += emoji;
    textarea.focus();
  };

  window.toggleDarkMode = function() {
    document.body.classList.toggle('dark');
    const isDark = document.body.classList.contains('dark');
    localStorage.setItem(darkKey, isDark ? "true" : "false");
  };

  function loadDarkMode() {
    const saved = localStorage.getItem(darkKey);
    if (saved === "true") {
      document.body.classList.add('dark');
    }
  }

  loadDarkMode();
  filterLogs();
}
</script>
</body>
</html>
